openapi: 3.0.3
info:
  title: Campus Event Calendar API
  version: 1.0.0
servers:
  - url: /api/v1

tags:
  - name: Auth
  - name: Users
  - name: Preference
  - name: Categories
  - name: Events
  - name: Bookmarks
  - name: Memos
  - name: Tags
  - name: Timetables
  - name: Courses

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ---------------- Common ----------------
    ErrorResponse:
      type: object
      required: [code, message]
      properties:
        code: { type: string }
        message: { type: string }

    PageMeta:
      type: object
      required: [page, size, total]
      properties:
        page: { type: integer, minimum: 1, example: 1 }
        size: { type: integer, minimum: 1, example: 20 }
        total: { type: integer, minimum: 0, example: 123 }

    # ---------------- Auth / User DTOs ----------------
    RegisterRequest:
      type: object
      required: [email, password]
      properties:
        email: { type: string, format: email }
        password: { type: string, minLength: 8 }
        username: { type: string, nullable: true }

    RegisterResponse:
      type: object
      required: [accessToken, refreshToken]
      properties:
        accessToken: { type: string }
        refreshToken: { type: string }

    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email: { type: string, format: email }
        password: { type: string }

    LoginResponse:
      type: object
      required: [accessToken, refreshToken]
      properties:
        accessToken: { type: string }
        refreshToken: { type: string }

    SocialRegisterRequest:
      type: object
      required: [provider, idToken]
      properties:
        provider:
          type: string
          enum: [LOCAL, GOOGLE, KAKAO, NAVER]
        idToken:
          type: string
          description: "provider에서 받은 idToken 또는 accessToken"
        username:
          type: string
          nullable: true
        email:
          type: string
          format: email
          nullable: true

    GetMeResponse:
      type: object
      required: [id]
      properties:
        id: { type: integer, format: int64 }
        username: { type: string, nullable: true }
        email: { type: string, format: email, nullable: true }
        profileImageUrl: { type: string, nullable: true }

    RefreshResponse:
      type: object
      required: [accessToken]
      properties:
        accessToken: { type: string }

    # ---------------- Categories ----------------
    CategoryGroupDto:
      type: object
      required: [id, name, sortOrder]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }
        sortOrder: { type: integer, description: "UI에서 고정 순서로 보여주기 위한 정렬값" }

    CategoryDto:
      type: object
      required: [id, groupId, name, sortOrder]
      properties:
        id: { type: integer, format: int64 }
        groupId: { type: integer, format: int64 }
        name: { type: string }
        sortOrder: { type: integer, description: "UI에서 고정 순서로 보여주기 위한 정렬값" }

    CategoryResponse:
      type: object
      required: [group, categories]
      properties:
        group: { $ref: '#/components/schemas/CategoryGroupDto' }
        categories:
          type: array
          items: { $ref: '#/components/schemas/CategoryDto' }

    # ---------------- Preference ----------------
    AddExcludedKeywordRequest:
      type: object
      required: [keyword]
      properties:
        keyword: { type: string, minLength: 1 }

    ListExcludedKeywordResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            type: object
            required: [id, keyword, createdAt]
            properties:
              id: { type: integer, format: int64 }
              keyword: { type: string }
              createdAt: { type: string, format: date-time }

    AddInterestCategoryRequest:
      type: object
      required: [categoryId, priority]
      properties:
        categoryId: { type: integer, format: int64 }
        priority:
          type: integer
          minimum: 1
          description: "유저가 설정한 관심 카테고리 우선순위 (1이 가장 높음)"

    UpdateInterestCategoryRequest:
      type: object
      required: [priority]
      properties:
        priority:
          type: integer
          minimum: 1
          description: "유저가 설정한 관심 카테고리 우선순위 (1이 가장 높음)"

    ListInterestCategoryResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            type: object
            required: [category, priority]
            properties:
              category: { $ref: '#/components/schemas/CategoryDto' }
              priority:
                type: integer
                minimum: 1
                description: "유저 관심 카테고리 우선순위 (1이 가장 높음)"

    # ---------------- Events ----------------
    EventDto:
      type: object
      required: [id, title, applyCount]
      properties:
        id: { type: integer, format: int64 }
        title: { type: string }
        imageUrl: { type: string, nullable: true }
        operationMode: { type: string, nullable: true }

        statusId: { type: integer, format: int64, nullable: true }
        eventTypeId: { type: integer, format: int64, nullable: true }
        orgId: { type: integer, format: int64, nullable: true }

        applyStart: { type: string, format: date-time, nullable: true }
        applyEnd: { type: string, format: date-time, nullable: true }
        eventStart: { type: string, format: date-time, nullable: true }
        eventEnd: { type: string, format: date-time, nullable: true }

        capacity: { type: integer, nullable: true }

        applyCount:
          type: integer
          example: 0
          description: |
            현재 이 이벤트에 대해 기록된 신청/관심 수.
            향후 정렬/인기 표시/마감 판단 등에 활용 가능.

        organization: { type: string, nullable: true }
        location: { type: string, nullable: true }
        applyLink: { type: string, nullable: true }

        # --- personalization (Authorization 헤더가 있을 때만 의미) ---
        isInterested:
          type: boolean
          nullable: true
          description: "유저 관심 카테고리와 매칭 여부(토큰 없으면 null 가능)"

        matchedInterestPriority:
          type: integer
          nullable: true
          description: |
            매칭된 관심 카테고리 중 가장 높은 우선순위 값 (1이 가장 높음).
            토큰 없으면 null 가능.

        isBookmarked:
          type: boolean
          nullable: true
          description: "유저가 북마크한 이벤트인지 여부(토큰 없으면 null 가능)"

        tags:
          type: array
          nullable: true
          items: { $ref: '#/components/schemas/TagDto' }
          description: |
            (개인화) 유저가 이 이벤트에 대해 추가한 태그 목록.
            - Authorization(로그인)일 때만 의미 있음
            - 비로그인 시 null 가능

    MonthEventResponse:
      type: object
      required: [range, byDate]
      properties:
        range:
          type: object
          required: [from, to]
          properties:
            from: { type: string, format: date }
            to: { type: string, format: date }
        byDate:
          type: object
          additionalProperties:
            type: object
            required: [total, preview]
            properties:
              total: { type: integer }
              preview:
                type: array
                items: { $ref: '#/components/schemas/EventDto' }

    DayEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [date, items]
          properties:
            date: { type: string, format: date }
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    TitleSearchEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [items]
          properties:
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    DetailEventResponse:
      allOf:
        - $ref: '#/components/schemas/EventDto'
        - type: object
          properties:
            detail:
              type: string
              nullable: true
              description: "모집 공고 상세 글(텍스트)"

    BookmarkedEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [items]
          properties:
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    # ---------------- Memos ----------------
    MemoDto:
      type: object
      required: [id, eventId, content, createdAt, updatedAt]
      properties:
        id: { type: integer, format: int64 }
        eventId: { type: integer, format: int64 }
        content: { type: string }
        tags:
          type: array
          items: { $ref: '#/components/schemas/TagDto' }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }

    CreateMemoRequest:
      type: object
      required: [eventId, content]
      properties:
        eventId: { type: integer, format: int64 }
        content: { type: string, minLength: 1 }
        tagIds:
          type: array
          items: { type: integer, format: int64 }
          nullable: true

    CreateMemoResponse:
      type: object
      required: [id]
      properties:
        id: { type: integer, format: int64 }

    UpdateMemoRequest:
      type: object
      properties:
        content: { type: string, nullable: true }
        tagIds:
          type: array
          items: { type: integer, format: int64 }
          nullable: true
      description: "content/tagIds 중 하나 이상 변경"

    UpdateMemoResponse:
      type: object
      required: [id]
      properties:
        id: { type: integer, format: int64 }

    ListMemoResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/MemoDto' }

    # ---------------- Tags ----------------
    TagDto:
      type: object
      required: [id, name]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }

    CreateTagRequest:
      type: object
      required: [name]
      properties:
        name: { type: string, minLength: 1 }

    CreateTagResponse:
      type: object
      required: [id]
      properties:
        id: { type: integer, format: int64 }

    UpdateTagRequest:
      type: object
      required: [name]
      properties:
        name: { type: string, minLength: 1 }

    UpdateTagResponse:
      type: object
      required: [id, name]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }

    ListTagResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/TagDto' }

    # ---------------- Timetables / Courses ----------------
    CreateTimetableRequest:
      type: object
      required: [name, year, semester]
      properties:
        name: { type: string }
        year: { type: integer }
        semester:
          type: string
          enum: [SPRING, SUMMER, FALL, WINTER]

    UpdateTimetableRequest:
      type: object
      required: [name]
      properties:
        name: { type: string }

    TimetableResponse:
      type: object
      required: [id, name, year, semester]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }
        year: { type: integer }
        semester:
          type: string
          enum: [SPRING, SUMMER, FALL, WINTER]

    AddCourseRequest:
      type: object
      required: [courseId]
      properties:
        courseId:
          type: integer
          format: int64
          description: "시간표에 추가할 강의 ID"

    AddCourseResponse:
      type: object
      required: [timetableCourseId]
      properties:
        timetableCourseId: { type: integer, format: int64 }

    CourseDto:
      type: object
      required: [id, year, semester, courseNumber, lectureNumber, courseTitle, startAt, endAt, credit]
      properties:
        id: { type: integer, format: int64 }
        year: { type: integer }
        semester:
          type: string
          enum: [SPRING, SUMMER, FALL, WINTER]
        courseNumber: { type: string }
        lectureNumber: { type: string }
        courseTitle: { type: string }
        startAt:
          type: integer
          format: int64
          description: "DB 타입이 bigint라면 '분/초 epoch' 등 규칙을 확정해서 맞추기"
        endAt:
          type: integer
          format: int64
        credit: { type: integer }
        instructor: { type: string, nullable: true }

    CourseSearchResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/CourseDto' }

paths:
  # ---------------- Auth ----------------
  /auth/register:
    post:
      tags: [Auth]
      summary: Local 회원가입
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RegisterRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/RegisterResponse' }
        "409":
          description: Conflict (이미 가입된 이메일 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /auth/login:
    post:
      tags: [Auth]
      summary: Local 로그인
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/LoginRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/LoginResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /auth/social:
    post:
      tags: [Auth]
      summary: 소셜 로그인/가입
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/SocialRegisterRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/LoginResponse' }
        "409":
          description: Conflict (동일 이메일의 LOCAL 계정 존재 → 로컬 로그인 유도)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /auth/logout:
    post:
      tags: [Auth]
      summary: 로그아웃
      security: [{ bearerAuth: [] }]
      responses:
        "204": { description: No Content }

  /auth/refresh:
    post:
      tags: [Auth]
      summary: AccessToken 재발급
      description: |
        refreshToken을 Authorization 헤더(Bearer)로 전달하여 새 accessToken을 발급합니다.
        (현재 버전에서는 refreshToken은 재발급되지 않습니다)
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/RefreshResponse' }

  # ---------------- Users ----------------
  /users/me:
    get:
      tags: [Users]
      summary: 내 정보 조회
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/GetMeResponse' }

  # ---------------- Categories ----------------
  /category-groups/with-categories:
    get:
      tags: [Categories]
      summary: 카테고리 그룹 + 카테고리 목록
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/CategoryResponse' }

  /categories/orgs:
    get:
      tags: [Categories]
      summary: 주체기관 카테고리 목록 조회
      description: |
        필터 UI(주체기관 드롭다운)에서 사용할 주체기관 목록을 반환합니다.
        - 내부적으로 "주체기관" category_group에 속한 categories를 조회합니다.
        - 반환된 items[].id 값을 이벤트 조회 API의 orgId 필터로 그대로 사용합니다.
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/CategoryDto' }

  # ---------------- Preference ----------------
  /users/me/excluded-keywords:
    get:
      tags: [Preference]
      summary: 제외 키워드 목록
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListExcludedKeywordResponse' }
    post:
      tags: [Preference]
      summary: 제외 키워드 추가
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AddExcludedKeywordRequest' }
      responses:
        "201": { description: Created }

  /users/me/interest-categories:
    get:
      tags: [Preference]
      summary: 관심 카테고리 목록 (우선순위 포함)
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListInterestCategoryResponse' }
    post:
      tags: [Preference]
      summary: 관심 카테고리 추가 (우선순위 포함)
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AddInterestCategoryRequest' }
      responses:
        "201": { description: Created }

  /users/me/interest-categories/{categoryId}:
    patch:
      tags: [Preference]
      summary: 관심 카테고리 우선순위 수정
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: categoryId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateInterestCategoryRequest' }
      responses:
        "200": { description: OK }
    delete:
      tags: [Preference]
      summary: 관심 카테고리 삭제
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: categoryId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  # ---------------- Events ----------------
  /events/month:
    get:
      tags: [Events]
      summary: 월별 캘린더 조회 (Public + Auto personalization on login)
      description: |
        Public API입니다.
        - (로그인 X) 기간(from~to) + 필터(선택) 조건으로 이벤트를 반환합니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
        - 이벤트 preview에는 tags, isBookmarked 등이 포함될 수 있습니다. (토큰 유무/데이터 존재에 따라 null 가능)
      security: []  # Authorization 헤더는 선택(있으면 서버가 personalization 적용)
      parameters:
        - in: query
          name: from
          required: true
          schema: { type: string, format: date }
        - in: query
          name: to
          required: true
          schema: { type: string, format: date }

        # filtering (optional) - 프로그램 유형/모집현황/주체기관 
        # 복수 카테고리 필터링: &statusId=3&statusId=4 와 같은 방식으로 동작
        - in: query
          name: statusId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: eventTypeId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: orgId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/MonthEventResponse' }

  /events/day:
    get:
      tags: [Events]
      summary: 일별 이벤트 조회(페이지네이션) (Public + Auto personalization on login)
      description: |
        Public API입니다.
        - (로그인 X) date + 필터(선택) 조건으로 이벤트를 반환합니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
        - 이벤트 preview에는 tags, isBookmarked 등이 포함될 수 있습니다. (토큰 유무/데이터 존재에 따라 null 가능)
      security: []
      parameters:
        - in: query
          name: date
          required: true
          schema: { type: string, format: date }
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }

        # filtering (optional) - 프로그램 유형/모집현황/주체기관 
        # 복수 카테고리 필터링: &statusId=3&statusId=4 와 같은 방식으로 동작
        - in: query
          name: statusId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: eventTypeId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: orgId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/DayEventResponse' }

  /events/search/title:
    get:
      tags: [Events]
      summary: 이벤트 제목 검색 (필터링과 별개 기능, Public + Auto personalization on login)
      description: |
        "제목 검색" 전용 API입니다. (필터링 기능과 별개)
        - query는 title contains 검색에 사용됩니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
      security: []
      parameters:
        - in: query
          name: query
          required: true
          schema: { type: string, minLength: 1 }
          description: "이벤트 제목(title) contains 검색"

        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TitleSearchEventResponse' }

  /events/{eventId}:
    get:
      tags: [Events]
      summary: 이벤트 상세 조회 (Public + Optional bookmark state)
      description: |
        Public API입니다.
        - (로그인 X) 이벤트 상세 정보만 반환합니다.
        - (로그인 O + 토큰 제공 시) isBookmarked, bookmarkCount 등 사용자 관련 필드가 채워집니다.
        ※ preference(interest/excluded) 반영 여부는 "목록/검색"에서 의미가 크고, 상세는 주로 bookmark 상태만 optional로 채우는 용도입니다.
      security: []
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/DetailEventResponse' }
        "404":
          description: Not Found
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  # ---------------- Bookmarks ----------------
  /events/{eventId}/bookmark:
    post:
      tags: [Bookmarks]
      summary: 북마크 추가
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }
    delete:
      tags: [Bookmarks]
      summary: 북마크 취소
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  /users/me/bookmarks:
    get:
      tags: [Bookmarks]
      summary: 북마크한 이벤트 목록
      security: [{ bearerAuth: [] }]
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/BookmarkedEventResponse' }

  # ---------------- Memos ----------------
  /memos:
    get:
      tags: [Memos]
      summary: 내 메모 목록
      security: [{ bearerAuth: [] }]
      parameters:
        - in: query
          name: eventId
          schema: { type: integer, format: int64 }
          description: "특정 이벤트의 메모만 보고 싶으면"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListMemoResponse' }
    post:
      tags: [Memos]
      summary: 메모 생성
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateMemoRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CreateMemoResponse' }

  /memos/{memoId}:
    patch:
      tags: [Memos]
      summary: 메모 수정
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: memoId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateMemoRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/UpdateMemoResponse' }
    delete:
      tags: [Memos]
      summary: 메모 삭제
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: memoId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  # ---------------- Tags ----------------
  /tags:
    get:
      tags: [Tags]
      summary: 태그 목록
      parameters:
        - in: query
          name: q
          schema: { type: string }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListTagResponse' }
    post:
      tags: [Tags]
      summary: 태그 생성
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateTagRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CreateTagResponse' }

  /tags/{tagId}:
    patch:
      tags: [Tags]
      summary: 태그 수정
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: tagId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateTagRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/UpdateTagResponse' }
    delete:
      tags: [Tags]
      summary: 태그 삭제
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: tagId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  # ---------------- Timetables ----------------
  /timetables:
    get:
      tags: [Timetables]
      summary: 내 시간표 목록
      security: [{ bearerAuth: [] }]
      parameters:
        - in: query
          name: year
          schema: { type: integer }
        - in: query
          name: semester
          schema:
            type: string
            enum: [SPRING, SUMMER, FALL, WINTER]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/TimetableResponse' }

    post:
      tags: [Timetables]
      summary: 시간표 생성
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateTimetableRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TimetableResponse' }

  /timetables/{timetableId}:
    patch:
      tags: [Timetables]
      summary: 시간표 이름 수정
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateTimetableRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TimetableResponse' }

    delete:
      tags: [Timetables]
      summary: 시간표 삭제
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  /timetables/{timetableId}/courses:
    post:
      tags: [Timetables]
      summary: 시간표에 강의 추가
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AddCourseRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/AddCourseResponse' }

  /timetables/{timetableId}/courses/{timetableCourseId}:
    delete:
      tags: [Timetables]
      summary: 시간표에서 강의 제거
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
        - in: path
          name: timetableCourseId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  # ---------------- Courses ----------------
  /courses/search:
    get:
      tags: [Courses]
      summary: 강의 검색
      parameters:
        - in: query
          name: year
          schema: { type: integer }
        - in: query
          name: semester
          schema:
            type: string
            enum: [SPRING, SUMMER, FALL, WINTER]
        - in: query
          name: q
          schema: { type: string }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CourseSearchResponse' }

  # ---------------- Health ----------------
  /health:
    get:
      summary: Health check
      responses:
        "200": { description: OK }