openapi: 3.0.3
info:
  title: Campus Event Calendar API
  version: 1.0.0
servers:
  - url: /api/v1

tags:
  - name: Auth
  - name: Users
  - name: Preference
  - name: Categories
  - name: Events
  - name: Bookmarks
  - name: Memos
  - name: Tags
  - name: Timetables
  - name: Courses

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ---------------- Common ----------------
    ErrorResponse:
      type: object
      required: [code, message]
      properties:
        code: { type: string }
        message: { type: string }

    PageMeta:
      type: object
      required: [page, size, total]
      properties:
        page: { type: integer, minimum: 1, example: 1 }
        size: { type: integer, minimum: 1, example: 20 }
        total: { type: integer, minimum: 0, example: 123 }

    CourseSource:
      type: string
      enum:
        - CRAWLED
        - CUSTOM
      description: |
        강의 출처 타입
        - CRAWLED: 학교/외부에서 크롤링한 강의 (수정 불가)
        - CUSTOM: 유저가 직접 생성한 강의 (수정 가능)

    DayOfWeek:
      type: string
      enum:
        - MON
        - TUE
        - WED
        - THU
        - FRI
        - SAT
        - SUN
      description: |
        요일
        - MON: 월요일
        - TUE: 화요일
        - WED: 수요일
        - THU: 목요일
        - FRI: 금요일
        - SAT: 토요일
        - SUN: 일요일

    Semester:
      type: string
      enum:
        - SPRING
        - SUMMER
        - FALL
        - WINTER
      description: |
        학기 구분
        - SPRING: 봄학기
        - SUMMER: 여름학기 (계절)
        - FALL: 가을학기
        - WINTER: 겨울학기 (계절)

    # ---------------- Auth / User DTOs ----------------
    RegisterRequest:
      type: object
      required: [email, password]
      properties:
        email: { type: string, format: email }
        password: { type: string, minLength: 8 }
        username: { type: string, nullable: true }

    RegisterResponse:
      type: object
      required: [accessToken]
      properties:
        accessToken: { type: string }

    LoginRequest:
      type: object
      required: [email, password]
      properties:
        email: { type: string, format: email }
        password: { type: string }

    LoginResponse:
      type: object
      required: [accessToken]
      properties:
        accessToken: { type: string }

    GetMeResponse:
      type: object
      required: [id]
      properties:
        id: { type: integer, format: int64 }
        username: { type: string, nullable: true }
        email: { type: string, format: email, nullable: true }
        profileImageUrl: { type: string, nullable: true }

    SocialLoginRequest:
      type: object
      required: [ provider, code ]
      properties:
        provider:
          type: string
          description: 소셜 로그인 Provider
          enum: [ GOOGLE, KAKAO, NAVER ]
        code:
          type: string
          description: OAuth Authorization Code
        codeVerifier:
          type: string
          nullable: true
          description: |
            Google PKCE code_verifier (선택).
            KAKAO/NAVER에서는 사용하지 않음.
      example:
        provider: GOOGLE
        code: "authorization_code_here"
        codeVerifier: "pkce_code_verifier_here"

    TokenResponse:
        type: object
        required: [ accessToken, isNewUser ]
        properties:
          accessToken:
            type: string
            description: 우리 서비스 Access JWT
          isNewUser:
            type: boolean
            description: 소셜 로그인 과정에서 신규 생성된 유저인지 여부
        example:
          accessToken: "access.jwt.token"
          isNewUser: false

    RefreshResponse:
        type: object
        required: [ accessToken ]
        properties:
          accessToken:
            type: string
            description: 새로 발급된 우리 서비스 Access JWT
        example:
          accessToken: "new.access.jwt.token"

    UpdateProfileRequest:
      type: object
      additionalProperties: false
      properties:
        username:
          type: string
          nullable: true
          description: |
            닉네임 변경.
            - 필드 미포함: 변경 없음
            - null: 값 비우기(삭제)
            - ""(빈 문자열): 서버는 빈 문자열도 값으로 저장합니다(현재 코드 기준).
        profileImageUrl:
          type: string
          nullable: true
          format: uri
          pattern: '^https?://.*'   # http/https만 허용
          description: |
            프로필 이미지 URL 변경.
            - 필드 미포함: 변경 없음
            - null: 값 비우기(삭제)
            - ""(빈 문자열): 서버에서 null로 처리(삭제)
      description: |
        내 프로필 PATCH.
        요청 바디는 username/profileImageUrl 중 하나 이상을 포함해야 함.

    # ---------------- Categories ----------------
    CategoryGroupDto:
      type: object
      required: [id, name, sortOrder]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }
        sortOrder: { type: integer, description: "UI에서 고정 순서로 보여주기 위한 정렬값" }

    CategoryDto:
      type: object
      required: [id, groupId, name, sortOrder]
      properties:
        id: { type: integer, format: int64 }
        groupId: { type: integer, format: int64 }
        name: { type: string }
        sortOrder: { type: integer, description: "UI에서 고정 순서로 보여주기 위한 정렬값" }

    CategoryResponse:
      type: object
      required: [group, categories]
      properties:
        group: { $ref: '#/components/schemas/CategoryGroupDto' }
        categories:
          type: array
          items: { $ref: '#/components/schemas/CategoryDto' }

    ListCategoryGroupWithCategoriesResponse:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/CategoryResponse' }

    ListOrgCategoriesResponse:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/CategoryDto' }


    # ---------------- Preference ----------------
    AddExcludedKeywordRequest:
      type: object
      required: [keyword]
      properties:
        keyword: { type: string, minLength: 1 }

    ListExcludedKeywordResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            type: object
            required: [id, keyword, createdAt]
            properties:
              id: { type: integer, format: int64 }
              keyword: { type: string }
              createdAt: { type: string, format: date-time }

    ReplaceAllInterestCategoriesRequest:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          minItems: 0
          description: "유저의 관심 카테고리 전체 목록을 이 배열로 교체합니다."
          items:
            type: object
            required: [ categoryId, priority ]
            properties:
              categoryId: { type: integer, format: int64 }
              priority:
                type: integer
                minimum: 1
                description: "1이 가장 높음. 권장: 1..N 연속, 중복 없음"



    UpdateInterestCategoryRequest:
      type: object
      required: [priority]
      properties:
        priority:
          type: integer
          minimum: 1
          description: "유저가 설정한 관심 카테고리 우선순위 (1이 가장 높음)"

    ListInterestCategoryResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            type: object
            required: [category, priority]
            properties:
              category: { $ref: '#/components/schemas/CategoryDto' }
              priority:
                type: integer
                minimum: 1
                description: "유저 관심 카테고리 우선순위 (1이 가장 높음)"

    # ---------------- Events ----------------
    EventDto:
      type: object
      required: [id, title, applyCount]
      properties:
        id: { type: integer, format: int64 }
        title: { type: string }
        imageUrl: { type: string, nullable: true }
        operationMode: { type: string, nullable: true }

        statusId: { type: integer, format: int64, nullable: true }
        eventTypeId: { type: integer, format: int64, nullable: true }
        orgId: { type: integer, format: int64, nullable: true }

        applyStart: { type: string, format: date-time, nullable: true }
        applyEnd: { type: string, format: date-time, nullable: true }
        eventStart: { type: string, format: date-time, nullable: true }
        eventEnd: { type: string, format: date-time, nullable: true }

        capacity: { type: integer, nullable: true }

        applyCount:
          type: integer
          example: 0
          description: |
            현재 이 이벤트에 대해 기록된 신청/관심 수.
            향후 정렬/인기 표시/마감 판단 등에 활용 가능.

        organization: { type: string, nullable: true }
        location: { type: string, nullable: true }
        applyLink: { type: string, nullable: true }

        # --- personalization (Authorization 헤더가 있을 때만 의미) ---
        isInterested:
          type: boolean
          nullable: true
          description: "유저 관심 카테고리와 매칭 여부(토큰 없으면 null 가능)"

        matchedInterestPriority:
          type: integer
          nullable: true
          description: |
            매칭된 관심 카테고리 중 가장 높은 우선순위 값 (1이 가장 높음).
            토큰 없으면 null 가능.

        isBookmarked:
          type: boolean
          nullable: true
          description: "유저가 북마크한 이벤트인지 여부(토큰 없으면 null 가능)"

        tags:
          type: array
          nullable: true
          items: { $ref: '#/components/schemas/TagDto' }
          description: |
            (개인화) 유저가 이 이벤트에 대해 추가한 태그 목록.
            - Authorization(로그인)일 때만 의미 있음
            - 비로그인 시 null 가능

    MonthEventResponse:
      type: object
      required: [range, byDate]
      properties:
        range:
          type: object
          required: [from, to]
          properties:
            from: { type: string, format: date }
            to: { type: string, format: date }
        byDate:
          type: object
          additionalProperties:
            type: object
            required: [total, preview]
            properties:
              total: { type: integer }
              preview:
                type: array
                items: { $ref: '#/components/schemas/EventDto' }

    DayEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [date, items]
          properties:
            date: { type: string, format: date }
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    TitleSearchEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [items]
          properties:
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    DetailEventResponse:
      allOf:
        - $ref: '#/components/schemas/EventDto'
        - type: object
          properties:
            detail:
              type: string
              nullable: true
              description: "모집 공고 상세 글(텍스트)"

    BookmarkedEventResponse:
      allOf:
        - $ref: '#/components/schemas/PageMeta'
        - type: object
          required: [items]
          properties:
            items:
              type: array
              items: { $ref: '#/components/schemas/EventDto' }

    # ---------------- Memos ----------------
    CreateMemoRequest:
      type: object
      required: [ eventId, content ]
      properties:
        eventId:
          type: integer
          format: int64
          example: 160
        content:
          type: string
          example: "memo-content"
        tagNames:
          type: array
          items:
            type: string
          default: [ ]
          example: [ "t1", "t2" ]

      # PATCH는 JsonNode 기반이라 "필드 미포함/ null / 값" 정책을 명확히 문서화
    UpdateMemoRequest:
      type: object
      additionalProperties: false
      properties:
        content:
          type: string
          nullable: true
          description: |
            - 미포함: 변경 없음
            - null: 값 비우기 (""로 저장)
            - string: 해당 값으로 업데이트
          example: "updated-content"
        tagNames:
          type: array
          nullable: true
          description: |
            - 미포함: 변경 없음
            - null: 태그 전부 제거
            - array: replace-all (중복은 distinct 처리)
          items:
            type: string
          example: [ "shared", "other" ]

    MemoResponse:
      type: object
      required: [ id, eventId, eventTitle, content, tags ]
      properties:
        id:
          type: integer
          format: int64
          example: 70
        eventId:
          type: integer
          format: int64
          example: 160
        eventTitle:
          type: string
          example: "EV1"
        content:
          type: string
          example: "m1"
        tags:
          type: array
          items:
            type: string
          example: [ "shared", "other" ]
        createdAt:
          type: string
          format: date-time
          nullable: true
          example: "2026-02-04T06:56:14.227038Z"
        updatedAt:
          type: string
          format: date-time
          nullable: true
          example: "2026-02-04T06:56:14.248542Z"

    ListMemoResponse:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/MemoResponse"

    # ---------------- Tags ----------------
    Tag:
      type: object
      required: [ id, userId, name ]
      properties:
        id:
          type: integer
          format: int64
          example: 1
        userId:
          type: integer
          format: int64
          example: 2
        name:
          type: string
          example: "shared"

    TagDto:
      type: object
      required: [ id, name]
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string

    ListTagResponse:
        type: object
        required: [ items ]
        properties:
          items:
            type: array
            items:
              $ref: "#/components/schemas/Tag"

    CreateTagRequest:
        type: object
        additionalProperties: false
        required: [ name ]
        properties:
          name:
            type: string
            example: "new-tag"

    CreateTagResponse:
        type: object
        required: [ id, name ]
        properties:
          id:
            type: integer
            format: int64
            example: 10
          name:
            type: string
            example: "new-tag"

    UpdateTagRequest:
        type: object
        additionalProperties: false
        required: [ name ]
        properties:
          name:
            type: string
            example: "changed"

    UpdateTagResponse:
        type: object
        required: [ id, name ]
        properties:
          id:
            type: integer
            format: int64
            example: 1
          name:
            type: string
            example: "changed"


    # ---------------- Timetables / Courses ----------------
    CreateTimetableRequest:
      type: object
      required: [name, year, semester]
      properties:
        name: { type: string }
        year: { type: integer }
        semester:
          type: string
          enum: [SPRING, SUMMER, FALL, WINTER]

    UpdateTimetableRequest:
      type: object
      required: [name]
      properties:
        name: { type: string }

    TimetableResponse:
      type: object
      required: [id, name, year, semester]
      properties:
        id: { type: integer, format: int64 }
        name: { type: string }
        year: { type: integer }
        semester:
          type: string
          enum: [SPRING, SUMMER, FALL, WINTER]

    ListTimetablesResponse:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/TimetableResponse' }

    ListEnrollsResponse:
      type: object
      required: [ items ]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/EnrollResponse' }

    EnrollResponse:
      type: object
      required: [ enrollId, course ]
      properties:
        enrollId: { type: integer, format: int64 }
        course: { $ref: '#/components/schemas/CourseDto' }

    CreateCustomCourseRequest:
      type: object
      required: [ year, semester, courseTitle, timeSlots ]
      additionalProperties: false
      properties:
        year: { type: integer }
        semester: { type: string, enum: [ SPRING, SUMMER, FALL, WINTER ] }
        courseTitle: { type: string }
        timeSlots:
          type: array
          items: { $ref: '#/components/schemas/CourseTimeSlotDto' }
          description: |
            시간 슬롯 목록.
            - 빈 배열/null: 허용하지 않음
            - 최소 1개 이상 필요

        # optional
        courseNumber: { type: string, nullable: true }
        lectureNumber: { type: string, nullable: true }
        credit: { type: integer, nullable: true }
        instructor: { type: string, nullable: true }

    UpdateCustomCourseRequest:
      type: object
      additionalProperties: false
      properties:
        courseTitle: { type: string, nullable: true }
        timeSlots:
          type: array
          nullable: true
          items: { $ref: '#/components/schemas/CourseTimeSlotDto' }
          description: |
            시간 슬롯 목록.
            - 미포함: 변경 없음
            - 빈 배열/null: 허용하지 않음 (서버 정책상 400 INVALID_REQUEST)
            - 최소 1개 이상 필요

        courseNumber: { type: string, nullable: true }
        lectureNumber: { type: string, nullable: true }
        credit: { type: integer, nullable: true }
        instructor: { type: string, nullable: true }

      description: |
        커스텀 강의 수정.
        - 필드 미포함: 변경 없음
        - null: 값 비우기(삭제) 의도
        - 단, courseTitle/timeSlots 는 "스키마상 nullable=true" 이지만 **서버 정책상 null 불가**이며,
          null 전달 시 400 (INVALID_REQUEST) 로 처리됩니다.
        - timeSlots 는 빈 배열도 금지(최소 1개 이상) → 400 (INVALID_REQUEST)

    CourseDto:
      type: object
      required: [ id, year, semester, courseTitle, source, timeSlots ]
      properties:
        id:
          type: integer
          format: int64

        year:
          type: integer

        semester:
          $ref: '#/components/schemas/Semester'

        courseTitle:
          type: string

        source:
          $ref: '#/components/schemas/CourseSource'


        timeSlots:
          type: array
          items:
            $ref: '#/components/schemas/CourseTimeSlotDto'

        # ---- 이하 optional / nullable ----
        courseNumber:
          type: string
          nullable: true

        lectureNumber:
          type: string
          nullable: true

        credit:
          type: integer
          nullable: true

        instructor:
          type: string
          nullable: true

    CourseTimeSlotDto:
      type: object
      required: [ dayOfWeek, startAt, endAt ]
      description: |
        시간 슬롯 단위.
        서버 검증 규칙:
        - startAt < endAt 이어야 함
        - startAt은 endAt보다 같거나 클 수 없음
        - 위반 시 400 INVALID_TIME_SLOT
      properties:
        dayOfWeek:
          $ref: '#/components/schemas/DayOfWeek'

        startAt:
          type: integer
          format: int64
          minimum: 0
          maximum: 1439
          description: "분 단위 (예: 630 = 10:30)"

        endAt:
          type: integer
          format: int64
          minimum: 1
          maximum: 1440

    # 추후 검색 기능 도입 시 필요
    CourseSearchResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items: { $ref: '#/components/schemas/CourseDto' }

    AddCourseRequest:
      type: object
      required: [ courseId ]
      properties:
        courseId:
          type: integer
          format: int64
          description: "시간표에 추가할 강의 ID"

    AddCourseResponse:
      type: object
      required: [ enrollId ]
      properties:
        enrollId: { type: integer, format: int64 }

paths:
  # ---------------- Auth ----------------
  /auth/register:
    post:
      tags: [Auth]
      summary: Local 회원가입
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RegisterRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/RegisterResponse' }
        "409":
          description: Conflict (이미 가입된 이메일 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /auth/login:
    post:
      tags: [Auth]
      summary: Local 로그인
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/LoginRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/LoginResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /auth/login/social:
    post:
      tags: [ Auth ]
      summary: 소셜 로그인 (code로 토큰 교환 후 우리 서비스 토큰 발급)
      description: |
        provider에 따라 code를 사용해 소셜 access token을 발급받고, 유저 정보를 조회한 뒤
        우리 서비스 access token + refresh token(cookie)을 발급합니다.
        refresh token은 Set-Cookie 헤더로 내려갑니다.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SocialLoginRequest'
            examples:
              google:
                summary: Google (PKCE 포함 가능)
                value:
                  provider: GOOGLE
                  code: "authorization_code_here"
                  codeVerifier: "pkce_code_verifier_here"
              kakao:
                summary: Kakao
                value:
                  provider: KAKAO
                  code: "authorization_code_here"
                  codeVerifier: null
              naver:
                summary: Naver
                value:
                  provider: NAVER
                  code: "authorization_code_here"
                  codeVerifier: null
      responses:
        "200":
          description: 로그인 성공 (accessToken 반환 + refreshToken 쿠키 세팅)
          headers:
            Set-Cookie:
              description: refreshToken 쿠키
              schema:
                type: string
              example: refreshToken=xxxxx.yyyyy.zzzzz; Path=/; HttpOnly; SameSite=Lax
          content:
            application/json:
              schema:
                { $ref: '#/components/schemas/ErrorResponse' }
              examples:
                existingUser:
                  value:
                    accessToken: "access.jwt.token"
                    isNewUser: false
                newUser:
                  value:
                    accessToken: "access.jwt.token"
                    isNewUser: true
        "400":
          { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          { $ref: '#/components/schemas/ErrorResponse' }
        "500":
          { $ref: '#/components/schemas/ErrorResponse' }

  /auth/logout:
    post:
      tags: [ Auth ]
      summary: 로그아웃 (refresh token revoke + 쿠키 삭제)
      description: |
        refreshToken이 있으면 DB에서 revoke 처리합니다.
        응답에서 refreshToken 쿠키를 삭제(Set-Cookie로 만료)합니다.
      parameters:
        - in: cookie
          name: refreshToken
          required: false
          schema:
            type: string
          description: HttpOnly refresh token 쿠키 (없어도 204 반환)
      responses:
        "204":
          description: 로그아웃 성공 (쿠키 삭제)
          headers:
            Set-Cookie:
              description: refreshToken 쿠키 삭제(만료)
              schema:
                type: string
              example: refreshToken=; Max-Age=0; Path=/; HttpOnly; SameSite=Lax
        "500":
          { $ref: '#/components/schemas/ErrorResponse' }

  /auth/refresh:
    post:
      tags: [ Auth ]
      summary: 액세스 토큰 재발급 (refresh token rotation)
      description: |
        refreshToken 쿠키를 받아 access token을 재발급합니다.
        동시에 refresh token을 rotation(기존 revoke + 새로 발급) 하고 Set-Cookie로 내려줍니다.
      parameters:
        - in: cookie
          name: refreshToken
          required: true
          schema:
            type: string
          description: HttpOnly refresh token 쿠키
      responses:
        "200":
          description: 재발급 성공 (accessToken 반환 + refreshToken 쿠키 갱신)
          headers:
            Set-Cookie:
              description: 갱신된 refreshToken 쿠키
              schema:
                type: string
              example: refreshToken=xxxxx.yyyyy.zzzzz; Path=/; HttpOnly; SameSite=Lax
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshResponse'
              example:
                accessToken: "new.access.jwt.token"
        "401":
          description: refreshToken이 없거나 유효하지 않음
          content:
            application/json:
              schema:
                { $ref: '#/components/schemas/ErrorResponse' }
        "500":
          { $ref: '#/components/schemas/ErrorResponse' }

  # ---------------- Users ----------------
  /users/me:
    get:
      tags: [Users]
      summary: 내 정보 조회
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/GetMeResponse' }

    patch:
      tags: [ Users ]
      summary: 내 프로필 수정 (username / profileImageUrl)
      description: |
        - 필드 미포함: 변경 없음
        - null: 해당 값 비우기(삭제)
      security: [ { bearerAuth: [ ] } ]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateProfileRequest' }
            examples:
              setUsername:
                value: { username: "dyang" }
              clearUsername:
                value: { username: null }
              clearProfileImage:
                value: { profileImageUrl: null }
      responses:
        "204": { description: No Content }
        "400":
          description: Bad Request
            - username/profileImageUrl 둘 다 없음
            - profileImageUrl이 유효한 http/https URL이 아님
            - username이 금칙어/예약어에 해당함 (USERNAME_NOT_ALLOWED)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  # ---------------- Categories ----------------
  /category-groups/with-categories:
    get:
      tags: [Categories]
      summary: 카테고리 그룹 + 카테고리 목록
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListCategoryGroupWithCategoriesResponse' }

  /categories/orgs:
    get:
      tags: [Categories]
      summary: 주체기관 카테고리 목록 조회
      description: |
        필터 UI(주체기관 드롭다운)에서 사용할 주체기관 목록을 반환합니다.
        - 내부적으로 "주체기관" category_group에 속한 categories를 조회합니다.
        - 반환된 items[].id 값을 이벤트 조회 API의 orgId 필터로 그대로 사용합니다.
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListOrgCategoriesResponse' }

  # ---------------- Preference ----------------
  /users/me/excluded-keywords:
    get:
      tags: [Preference]
      summary: 제외 키워드 목록
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListExcludedKeywordResponse' }
    post:
      tags: [Preference]
      summary: 제외 키워드 추가
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AddExcludedKeywordRequest' }
      responses:
        "201": { description: Created }

  /users/me/interest-categories:
    get:
      tags: [Preference]
      summary: 관심 카테고리 목록 (우선순위 포함)
      security: [{ bearerAuth: [] }]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListInterestCategoryResponse' }

    put:
      tags: [ Preference ]
      summary: 관심 카테고리 전체 교체(배치 저장)
      description: |
        유저의 관심 카테고리 구성을 요청 바디의 items로 "전체 교체"합니다.
        - items가 빈 배열이면 관심 카테고리를 모두 삭제합니다.
        - 권장 규칙: priority는 1..N 연속 + 중복 없음 (서버에서 검증)
      security: [ { bearerAuth: [ ] } ]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ReplaceAllInterestCategoriesRequest' }
      responses:
        "204": { description: No Content }
        "400":
          description: Bad Request (중복 categoryId/priority, priority 규칙 위반 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /users/me/interest-categories/{categoryId}:
    delete:
      tags: [Preference]
      summary: 관심 카테고리 삭제
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: categoryId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  # ---------------- Events ----------------
  /events/month:
    get:
      tags: [Events]
      summary: 월별 캘린더 조회 (Public + Auto personalization on login)
      description: |
        Public API입니다.
        - (로그인 X) 기간(from~to) + 필터(선택) 조건으로 이벤트를 반환합니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
        - 이벤트 preview에는 tags, isBookmarked 등이 포함될 수 있습니다. (토큰 유무/데이터 존재에 따라 null 가능)
      security: []  # Authorization 헤더는 선택(있으면 서버가 personalization 적용)
      parameters:
        - in: query
          name: from
          required: true
          schema: { type: string, format: date }
        - in: query
          name: to
          required: true
          schema: { type: string, format: date }

        # filtering (optional) - 프로그램 유형/모집현황/주체기관 
        # 복수 카테고리 필터링: &statusId=3&statusId=4 와 같은 방식으로 동작
        - in: query
          name: statusId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: eventTypeId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: orgId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/MonthEventResponse' }

  /events/day:
    get:
      tags: [Events]
      summary: 일별 이벤트 조회(페이지네이션) (Public + Auto personalization on login)
      description: |
        Public API입니다.
        - (로그인 X) date + 필터(선택) 조건으로 이벤트를 반환합니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
        - 이벤트 preview에는 tags, isBookmarked 등이 포함될 수 있습니다. (토큰 유무/데이터 존재에 따라 null 가능)
      security: []
      parameters:
        - in: query
          name: date
          required: true
          schema: { type: string, format: date }
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }

        # filtering (optional) - 프로그램 유형/모집현황/주체기관 
        # 복수 카테고리 필터링: &statusId=3&statusId=4 와 같은 방식으로 동작
        - in: query
          name: statusId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: eventTypeId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true
        - in: query
          name: orgId
          required: false
          schema:
            type: array
            items: { type: integer, format: int64 }
          style: form
          explode: true

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/DayEventResponse' }

  /events/search/title:
    get:
      tags: [Events]
      summary: 이벤트 제목 검색 (필터링과 별개 기능, Public + Auto personalization on login)
      description: |
        "제목 검색" 전용 API입니다. (필터링 기능과 별개)
        - query는 title contains 검색에 사용됩니다.
        - (로그인 O, Authorization: Bearer <token> 제공 시) 개인화가 자동 적용됩니다:
          1) excluded keyword: title에 제외 키워드가 포함된 이벤트는 항상 제외
          2) interest category: 유저 관심 카테고리 priority 기반으로 매칭 이벤트를 항상 상단에 우선 노출
      security: []
      parameters:
        - in: query
          name: query
          required: true
          schema: { type: string, minLength: 1 }
          description: "이벤트 제목(title) contains 검색"

        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }

      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TitleSearchEventResponse' }

  /events/{eventId}:
    get:
      tags: [Events]
      summary: 이벤트 상세 조회 (Public + Optional bookmark state)
      description: |
        Public API입니다.
        - (로그인 X) 이벤트 상세 정보만 반환합니다.
        - (로그인 O + 토큰 제공 시) isBookmarked, bookmarkCount 등 사용자 관련 필드가 채워집니다.
        ※ preference(interest/excluded) 반영 여부는 "목록/검색"에서 의미가 크고, 상세는 주로 bookmark 상태만 optional로 채우는 용도입니다.
      security: []
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/DetailEventResponse' }
        "404":
          description: Not Found
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  # ---------------- Bookmarks ----------------
  /events/{eventId}/bookmark:
    post:
      tags: [Bookmarks]
      summary: 북마크 추가
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }
    delete:
      tags: [Bookmarks]
      summary: 북마크 취소
      security: [{ bearerAuth: [] }]
      parameters:
        - in: path
          name: eventId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }

  /users/me/bookmarks:
    get:
      tags: [Bookmarks]
      summary: 북마크한 이벤트 목록
      security: [{ bearerAuth: [] }]
      parameters:
        - in: query
          name: page
          schema: { type: integer, default: 1 }
        - in: query
          name: size
          schema: { type: integer, default: 20 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/BookmarkedEventResponse' }

  # ---------------- Memos ----------------
  /memos:
    post:
      tags: [ Memos ]
      summary: Create memo
      description: |
        메모를 생성합니다.
        - tagNames에 포함된 태그가 없어도 생성
        - tagNames는 유저 스코프이며 중복 입력은 distinct 처리됩니다. (중복 입력 처리 따로 안 해도 됨)
      security:
        - bearerAuth: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateMemoRequest"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MemoResponse"
        "401":
          description: Unauthorized
        "404":
          description: EVENT_NOT_FOUND
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                eventNotFound:
                  value:
                    code: EVENT_NOT_FOUND
                    message: "행사를 찾을 수 없습니다"

    get:
      tags: [ Memos ]
      summary: Get my memos
      description: 내 메모를 createdAt 내림차순으로 반환합니다.
      security:
        - bearerAuth: [ ]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListMemoResponse"
        "401":
          description: Unauthorized

  /memos/by-tag/{tagId}:
      get:
        tags: [ Memos ]
        summary: Get my memos by tag
        description: |
          특정 태그(tagId)를 가진 내 메모 목록을 반환합니다.
          - tagId가 존재하지 않거나, 내 태그가 아니면 TAG_NOT_FOUND(404)
        security:
          - bearerAuth: [ ]
        parameters:
          - name: tagId
            in: path
            required: true
            schema:
              type: integer
              format: int64
            example: 123
        responses:
          "200":
            description: OK
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ListMemoResponse"
          "401":
            description: Unauthorized
          "404":
            description: TAG_NOT_FOUND
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
                examples:
                  tagNotFound:
                    value:
                      code: TAG_NOT_FOUND
                      message: "태그를 찾을 수 없습니다"

  /memos/{memoId}:
      patch:
        tags: [ Memos ]
        summary: Update memo (patch)
        description: |
          메모를 부분 수정합니다.

          **PATCH 정책**
          - 필드 미포함: 변경 없음
          - content: null → 값 비우기 ("" 저장)
          - tagNames: null → 태그 전부 제거
          - tagNames: array → replace-all (중복은 distinct)

          ※ content, tagNames 둘 다 미포함이면 INVALID_REQUEST
        security:
          - bearerAuth: [ ]
        parameters:
          - name: memoId
            in: path
            required: true
            schema:
              type: integer
              format: int64
            example: 70
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpdateMemoRequest"
              examples:
                updateContentOnly:
                  value:
                    content: "new content"
                clearContent:
                  value:
                    content: null
                replaceTags:
                  value:
                    tagNames: [ "shared", "other" ]
                clearTags:
                  value:
                    tagNames: null
                updateBoth:
                  value:
                    content: "updated"
                    tagNames: [ "t1", "t2" ]
        responses:
          "200":
            description: OK
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/MemoResponse"
          "400":
            description: INVALID_REQUEST
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
                examples:
                  invalidRequest:
                    value:
                      code: INVALID_REQUEST
                      message: "잘못된 요청입니다"
          "401":
            description: Unauthorized
          "404":
            description: MEMO_NOT_FOUND
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
                examples:
                  memoNotFound:
                    value:
                      code: MEMO_NOT_FOUND
                      message: "메모를 찾을 수 없습니다"

      delete:
        tags: [ Memos ]
        summary: Delete memo
        description: |
          메모를 삭제합니다.
          - memo_tags는 FK cascade로 함께 삭제됩니다.
          - tags 테이블의 태그는 삭제하지 않습니다. (명시적 삭제만)
        security:
          - bearerAuth: [ ]
        parameters:
          - name: memoId
            in: path
            required: true
            schema:
              type: integer
              format: int64
            example: 70
        responses:
          "204":
            description: No Content
          "401":
            description: Unauthorized
          "404":
            description: MEMO_NOT_FOUND
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
                examples:
                  memoNotFound:
                    value:
                      code: MEMO_NOT_FOUND
                      message: "메모를 찾을 수 없습니다"

  # ---------------- Tags ----------------
  /tags:
    get:
      summary: 내 태그 전체 조회
      description: 로그인한 사용자의 태그 목록을 반환합니다.
      tags: [ Tags ]
      security:
        - bearerAuth: [ ]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListTagResponse"
              examples:
                success:
                  value:
                    items:
                      - id: 1
                        name: "shared"
                      - id: 2
                        name: "other"
        "401":
          description: Unauthorized (토큰 없음/만료)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    post:
      summary: 태그 생성
      description: 로그인한 사용자의 태그를 생성합니다. 동일 유저 내 중복 이름은 409입니다.
      tags: [ Tags ]
      security:
        - bearerAuth: [ ]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTagRequest"
            examples:
              example:
                value:
                  name: "new-tag"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateTagResponse"
              examples:
                success:
                  value:
                    id: 10
                    name: "new-tag"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: TAG_ALREADY_EXISTS
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /tags/{tagId}:
      patch:
        summary: 태그 이름 수정
        description: 로그인한 사용자가 소유한 태그의 이름을 수정합니다.
        tags: [ Tags ]
        security:
          - bearerAuth: [ ]
        parameters:
          - in: path
            name: tagId
            required: true
            schema:
              type: integer
              format: int64
            example: 1
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UpdateTagRequest"
              examples:
                example:
                  value:
                    name: "changed"
        responses:
          "200":
            description: OK
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/UpdateTagResponse"
                examples:
                  success:
                    value:
                      id: 1
                      name: "changed"
          "401":
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
          "404":
            description: TAG_NOT_FOUND (없거나 내 소유가 아님)
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
          "409":
            description: TAG_ALREADY_EXISTS (내 다른 태그와 이름 중복)
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"

      delete:
        summary: 태그 삭제
        description: 로그인한 사용자가 소유한 태그를 삭제합니다.
        tags: [ Tags ]
        security:
          - bearerAuth: [ ]
        parameters:
          - in: path
            name: tagId
            required: true
            schema:
              type: integer
              format: int64
            example: 1
        responses:
          "204":
            description: No Content
          "401":
            description: Unauthorized
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"
          "404":
            description: TAG_NOT_FOUND (없거나 내 소유가 아님)
            content:
              application/json:
                schema:
                  $ref: "#/components/schemas/ErrorResponse"

  # ---------------- Timetables ----------------
  /timetables:
    get:
      tags: [ Timetables ]
      summary: 내 시간표 목록
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: query
          name: year
          schema: { type: integer }
        - in: query
          name: semester
          schema:
            type: string
            enum: [ SPRING, SUMMER, FALL, WINTER ]
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListTimetablesResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

    post:
      tags: [ Timetables ]
      summary: 시간표 생성
      security: [ { bearerAuth: [ ] } ]
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateTimetableRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TimetableResponse' }
        "400":
          description: Bad Request (name blank 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /timetables/{timetableId}:
    patch:
      tags: [ Timetables ]
      summary: 시간표 이름 수정
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateTimetableRequest' }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/TimetableResponse' }
        "400":
          description: Bad Request (name blank 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (시간표 없음/권한 없음 포함)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

    delete:
      tags: [ Timetables ]
      summary: 시간표 삭제
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (시간표 없음/권한 없음 포함)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /timetables/{timetableId}/enrolls:
    get:
      tags: [ Timetables ]
      summary: 시간표 강의 목록 조회
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ListEnrollsResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (시간표 없음/권한 없음 포함)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

    post:
      tags: [ Timetables ]
      summary: 시간표에 크롤링 강의 추가
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AddCourseRequest' }
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/AddCourseResponse' }
        "400":
          description: Bad Request (CRAWLED 강의만 허용, 요청 형식 오류 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (시간표 없음/권한 없음, courseId에 해당하는 강의 없음)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "409":
          description: Conflict (이미 시간표에 추가된 강의)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /timetables/{timetableId}/enrolls/custom:
    post:
      tags: [ Timetables ]
      summary: 시간표에 커스텀 강의 생성 + 추가
      description: |
        유저가 직접 정의한 강의(CUSTOM)를 생성하고, 해당 시간표에 바로 추가합니다.
        - 생성된 강의는 source=CUSTOM 입니다.
        - year/semester는 시간표의 year/semester와 일치해야 합니다(권장: 서버에서 검증).
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateCustomCourseRequest' }
            examples:
              example:
                value:
                  year: 2025
                  semester: FALL
                  courseTitle: "운동과 건강"
                  timeSlots:
                    - dayOfWeek: MON
                      startAt: 630
                      endAt: 705
                    - dayOfWeek: WED
                      startAt: 630
                      endAt: 705
                  instructor: "홍길동"
                  credit: 2
      responses:
        "201":
          description: Created
          content:
            application/json:
              schema: { $ref: '#/components/schemas/EnrollResponse' }
        "400":
          description: |
            Bad Request.
            다음 경우 발생:
            - timeSlots가 null 또는 빈 배열
            - CourseTimeSlotDto에서 startAt >= endAt
            - 시간 범위가 0~1440을 벗어남
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (시간표 없음)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

  /timetables/{timetableId}/enrolls/{enrollId}:
    get:
      tags: [ Timetables ]
      summary: 시간표 강의 단건 조회
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
        - in: path
          name: enrollId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/EnrollResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (해당 Enroll 없음/권한 없음 포함)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }

    patch:
      tags: [ Timetables ]
      summary: 시간표의 커스텀 강의 수정
      description: |
        시간표에 포함된 강의 중 source=CUSTOM 인 경우에만 수정 가능합니다.
        정책:
        - 필드 미포함: 변경 없음
        - null: (원칙적으로) 값 비우기(삭제)
        - 단, courseTitle/timeSlots는 null로 비우기(삭제) 금지 → 400 INVALID_REQUEST
        - timeSlots는 빈 배열도 금지(최소 1개 이상) → 400 INVALID_REQUEST
        - source=CRAWLED 강의는 수정 불가 → 403
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
        - in: path
          name: enrollId
          required: true
          schema: { type: integer, format: int64 }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateCustomCourseRequest' }
            examples:
              updateTitle:
                value: { courseTitle: "운동과 건강(수정)" }
              updateTimeSlots:
                value:
                  timeSlots:
                    - dayOfWeek: TUE
                      startAt: 600
                      endAt: 675
              invalidClearTitle:
                value: { courseTitle: null }
              invalidClearTimeSlots:
                value: { timeSlots: null }
              invalidEmptyTimeSlots:
                value: { timeSlots: [ ] }
      responses:
        "200":
          description: OK (수정된 결과 반환)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/EnrollResponse' }
        "400":
          description: Bad Request (요청 바디가 비어있음/검증 실패/courseTitle|null/timeSlots|null/빈 배열 등)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "401":
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "403":
          description: Forbidden (source=CRAWLED 강의 수정 시도)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
        "404":
          description: Not Found (해당 enroll 없음/권한 없음 포함)
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorResponse' }
    delete:
      tags: [ Timetables ]
      summary: 시간표에서 강의 제거
      security: [ { bearerAuth: [ ] } ]
      parameters:
        - in: path
          name: timetableId
          required: true
          schema: { type: integer, format: int64 }
        - in: path
          name: enrollId
          required: true
          schema: { type: integer, format: int64 }
      responses:
        "204": { description: No Content }
        "404": { description: Not found}

  # ---------------- Courses ----------------
  /courses/search:
    get:
      tags: [Courses]
      summary: 강의 검색
      parameters:
        - in: query
          name: year
          schema: { type: integer }
        - in: query
          name: semester
          schema:
            type: string
            enum: [SPRING, SUMMER, FALL, WINTER]
        - in: query
          name: q
          schema: { type: string }
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CourseSearchResponse' }

  # ---------------- Health ----------------
  /health:
    get:
      summary: Health check
      responses:
        "200": { description: OK }